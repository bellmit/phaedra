<project name="eu.openanalytics.phaedra.installer" default="all">
	
	<property file="build.properties" />
	
	<condition property="iswin32">
		<os family="windows"/>
	</condition>
	
	<target name="prepare-installer">
		<delete dir="${build.dir}" />
		<unzip dest="${build.dir}/phaedra">
			<fileset dir="${product.dir}">
				<include name="*-win32.win32.x86_64.zip" />
			</fileset>
		</unzip>
	</target>
	
	<target name="make-installer" depends="prepare-installer">
		<copy todir="${build.dir}">
			<fileset dir=".">
				<include name="*.nsi" />
				<include name="*.ico" />
				<include name="*.bmp" />
			</fileset>
		</copy>
		<exec executable="${nsisMaker}" dir="${build.dir}">
			<arg value="phaedra_x86_64.nsi" />
		</exec>
		<delete dir="${build.dir}/phaedra" />
		<move todir="${project.build.directory}">
		    <fileset dir="${build.dir}"/>
		</move>
	</target>
	
	<target name="all" if="iswin32">
		<antcall target="make-installer"/>
	</target>
	
</project>